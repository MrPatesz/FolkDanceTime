@using Client
@inject NavigationManager NavigationManager
@inject ICategoryClient CategoryClient

<MudPaper
    Class="d-flex justify-content-between align-center cursor-pointer"
    @onclick="@NavigateToDetails"
>
    <MudText Class="py-3 px-4">
        @Category.Name
    </MudText>
    <MudIconButton
        Color="Color.Error"
        Icon="@Icons.Filled.RemoveCircle"
        @onclick="@DeleteCategory"
    />
</MudPaper>

@code {
    [Parameter]
    public CategoryDto Category { get; set; }
    [Parameter]
    public EventCallback<int> OnDelete { get; set; }

    protected async Task DeleteCategory()
    {
        // TODO confirm dialog

        try
        {
            await CategoryClient.DeleteCategoryAsync(Category.Id);
            await OnDelete.InvokeAsync(Category.Id);
        }
        catch (Exception e)
        {
            // TODO toast message: something went wrong
            // can't delete when there are items in the category
        }
    }

    protected void NavigateToDetails()
    {
         NavigationManager.NavigateTo($"categories/{Category.Id}");
    }
}
