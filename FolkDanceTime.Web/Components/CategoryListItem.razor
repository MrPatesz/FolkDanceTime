@using Client
@inject NavigationManager NavigationManager
@inject ICategoryClient CategoryClient

<MudPaper
    Class="cursor-pointer"
    @onclick="@NavigateToDetails"
>
    <MudStack
        Row
        Justify="Justify.SpaceBetween"
        AlignItems="AlignItems.Center"
    >
        <MudText Class="px-3">
            @Category.Name
        </MudText>
        <MudIconButton
            Color="Color.Error"
            Icon="@Icons.Filled.RemoveCircle"
            OnClick="@DeleteCategory"
        />
    </MudStack>
</MudPaper>

@code {
    [Parameter]
    public CategoryDto Category { get; set; }
    [Parameter]
    public EventCallback<int> OnDelete { get; set; }

    protected async Task DeleteCategory()
    {
        // TODO confirm dialog

        try
        {
            await CategoryClient.DeleteCategoryAsync(Category.Id);
            await OnDelete.InvokeAsync(Category.Id);
        }
        catch (Exception e)
        {
            // TODO toast message: something went wrong
            // can't delete when there are items in the category
        }
    }

    protected void NavigateToDetails()
    {
         NavigationManager.NavigateTo($"categories/{Category.Id}");
    }
}
